<!doctype html>
<html lang="en">

<head>
    <title>--==[ HC ]==--</title>
    <link rel="icon" type="image/png" href="material-kit/assets/img/favicon.png">
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <!-- Fonts and icons -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
    <!-- Material Kit CSS -->
    <link href="material-kit/assets/css/material-kit.css?v=2.2.0" rel="stylesheet" />
    <style>
        .alert-doctor {
            color: #114e7e;
            background-color: #e8f8ff;
        }
    </style>
    <!-- Mock data -->
    <script>
        const tday = new Date();
        const minDaysGreenInventory = 7;    // 3-7 days and inventory will appear yellow (warning colour)
        const minDaysYellowInventory = 3;   // <3 days and inventory will appear red (critical colour)
        const maxCBD = 40;
        const maxTHC = 50;
        //Special case where a is in local time and b is in UTC
        function dateDiffInDays(a, b) {
            // Discard the time and time-zone information.
            b = new Date(b.getTime() + tday.getTimezoneOffset() * 60000); //Since b's TZ is not specified it will be treated as UTC, we have to add the offset to get it to local time so that when it's converted to UTC it does not slide back a day.
            const utc1 = Date.UTC(a.getFullYear(), a.getMonth(), a.getDate());
            const utc2 = Date.UTC(b.getFullYear(), b.getMonth(), b.getDate());
            return Math.floor((utc2 - utc1) / 86400000);    //milliseconds in a day (1000*60*60*24)
        }

        hcData = {
            "Demographics": {
                "lastName": "Bourne",
                "firstName": "Jason",
                "dob": "April 20, 1970 (49)",
                "gender": "Male",
                "identifiesAs": "They",
                "weight": "84.3 kgs (186 lbs)",
                "height": "178 cm (5' 10\")",
                "photo": "material-kit/assets/img/OntDriversLicense.jpg",
                "conditions": [
                    " Osteoarthritis",
                    " Insomnia",
                    " Hypertension",
                ],
                "contraindications": [
                    "Percocets 2012-2014",
                ],
            },
            "Clinical": {
                "prescribingHCP": "Dr. Mary Smith",
                "clinic": "Wise Elephant FHT",
                "prescriptions": {
                    "strain": "Sativa",
                    "format": "dried",
                    "cbdPercent": "15",
                    "thcPercent": "5",
                },
            }
        }

        var tabledata = [
            { id: 1, strain: "Bob Marley Special", lp: "AuroraMock", cbd: "5", thc: "30", format: "dried", rating: "4.5", inventoryExpiry: "2020-01-17", unitPrice: "12.95", units: "g" },
            { id: 2, strain: "Purple Kush", lp: "AuroraMock", cbd: "10", thc: 20, format: "dried", rating: "4.2", inventoryExpiry: "2020-01-18", unitPrice: "11.20", units: "g" },
            { id: 3, strain: "CBD Drops", lp: "AuroraMock", cbd: 0.8, thc: "22-30", format: "oil", rating: "4.1", inventoryExpiry: "2020-01-19", unitPrice: "11.20", units: "g" },
            { id: 4, strain: "Raspberry THC Gummies", lp: "AuroraMock", cbd: 0, thc: 2, format: "edible", rating: "2", inventoryExpiry: "2020-01-20", unitPrice: "11.20", units: "g" },
            { id: 5, strain: "Aurora THC Drops", lp: "AuroraMock", cbd: 0, thc: 27, format: "oil", rating: "4.2", inventoryExpiry: "2020-01-21", unitPrice: "11.20", units: "g" },
            { id: 6, strain: "Ambition", lp: "AuroraMock", cbd: 1, thc: 1, format: "dried", rating: "4.2", inventoryExpiry: "2020-01-22", unitPrice: "11.20", units: "g" },
            { id: 7, strain: "a", lp: "AuroraMock", cbd: 40, thc: 40, format: "dried", rating: "4.2", inventoryExpiry: "2020-01-21", unitPrice: "11.20", units: "g" },
            { id: 8, strain: "b", lp: "AuroraMock", cbd: 2, thc: 2, format: "dried", rating: "4.2", inventoryExpiry: "2020-01-22", unitPrice: "11.20", units: "g" },
            { strain: "c", lp: "AuroraMock", cbd: 3, thc: 3, format: "dried", rating: "4.2", inventoryExpiry: "2020-01-23", unitPrice: "11.20", units: "g" },
            { strain: "d", lp: "AuroraMock", cbd: 4, thc: 4, format: "dried", rating: "4.2", inventoryExpiry: "2020-01-24", unitPrice: "11.20", units: "g" },
            { strain: "e", lp: "AuroraMock", cbd: 5, thc: 5, format: "dried", rating: "4.2", inventoryExpiry: "2020-01-23", unitPrice: "11.20", units: "g" },
            { strain: "f", lp: "AuroraMock", cbd: 40, thc: 50, format: "dried", rating: "4.2", inventoryExpiry: "2020-01-24", unitPrice: "11.20", units: "g" },
        ];
        //Product table hygiene: transform/normalize data into presentation format
        for (var i = 0; i < tabledata.length; i++) {
            d = dateDiffInDays(tday, new Date(tabledata[i]["inventoryExpiry"]));
            t = d >= minDaysGreenInventory ? 2 : (d >= minDaysYellowInventory ? 1 : 0);
            tabledata[i]["inStock"] = t;
            tabledata[i]["displayCost"] = tabledata[i]["unitPrice"] + "/" + tabledata[i]["units"];
            s = tabledata[i]["cbd"];
            if (typeof s == "string") { s = s.replace(/\-[\s\S]*/, ""); }
            tabledata[i]["cbdProgress"] = s / maxCBD * 100;
            s = tabledata[i]["thc"];
            if (typeof s == "string") { s = s.replace(/\-[\s\S]*/, ""); }
            tabledata[i]["thcProgress"] = s / maxTHC * 100;
        }

    </script>
</head>

<body onload="onLoadReady()">

    <div class="card" style="margin-top: 0px; margin-bottom: 0px; background-color: #eee;">
        <div class="card-body ">
            <div class="row">
                <div class="">
                    <button class="" data-toggle="modal" data-target="#smallAlertModal" style="border-width: 0px; background-color: #eee;">
                        <div class="author" style="background-color: #eee;">
                            <img id="hc_photoSml" src="" class="avatar img-raised" style="width: 55px; height: 55px;">
                        </div>
                    </button>
                    <!-- modal large photo -->
                    <div class="modal fade" id="smallAlertModal" tabindex="-1" role="dialog">
                        <div class="modal-dialog modal-small" role="document">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="material-icons">clear</i></button>
                                </div>
                                <div class="modal-body text-center">
                                    <img id="hc_photoLrg" src="" class="avatar img-raised" style="width: 250px; height: 250px;"></br>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- end modal -->
                </div>
                <div class="col-10">
                    <div class="row">
                        <div class="col-12">
                            <div class="row">
                                <div class="col"><span id="hc_name"></span></div>
                                <div class="col-lg"><b>DOB:</b> <span id="hc_dob"></span></div>
                                <div class="col"><b>Gender (at birth):</b> <span id="hc_gender"></span></div>
                                <div class="col"><span id="hc_identifiesAsContainer"><b>Identifies as:</b> <span id="hc_identifiesAs"></span></span></div>
                                <div class="col-xl"><b>Weight:</b> <span id="hc_weight"></span></div>
                                <div class="col"><b>Height:</b> <span id="hc_height"></span></div>
                            </div>
                        </div>
                        <div class="col-12">
                            <div class="row">

                                <div class="col"><span>
                                        <i class="material-icons" style="  margin: 0;position: relative;top: 8px;">
                                            healing</i>
                                        <b>Condition(s):</b> <span id="hc_conditions"></span>
                                    </span></div>
                                <div class="col-lg"><span>
                                        <i class="material-icons" style="  margin: 0;position: relative;top: 8px;">
                                            warning</i>
                                        <b>Possible contraindication(s):</b> <span id="hc_contraindications"></span>
                                    </span></div>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="card" style="margin-top: 0px; margin-bottom: 0px;">
        <div class="card-body " style="background-color: #ffffff;">
            <div class="row">
                <div class="col-sm-auto">
                    <b>Rx:</b> <span id="hc_prescribingHCP" class="alert-doctor"></span> </br>
                    &nbsp; <span id="hc_clinic" class="alert-doctor"></span>
                </div>

                <div class="col-md-auto">
                    <div class="row">
                        <div class="col">
                            <b>Strain:</b> <span id="hc_strain" class="alert-doctor"></span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="form-check form-check-inline" style="margin: 0px;">
                                <label class="form-check-label" style="color: #000000; padding-left: 20px;">
                                    <input class="form-check-input" type="checkbox" id="hc_strainIndica" value="option1">Indica&nbsp;&nbsp;
                                    <span class="form-check-sign">
                                        <span class="check"></span>
                                    </span>
                                </label>
                            </div>
                            <div class="form-check form-check-inline" style="margin: 0px;">
                                <label class="form-check-label" style="color: #000000; padding-left: 20px;">
                                    <input class="form-check-input" type="checkbox" id="hc_strainSativa" value="option2">Sativa&nbsp;&nbsp;
                                    <span class="form-check-sign">
                                        <span class="check"></span>
                                    </span>
                                </label>
                            </div>
                            <div class="form-check form-check-inline" style="margin: 0px;">
                                <label class="form-check-label" style="color: #000000; padding-left: 20px;">
                                    <input class="form-check-input" type="checkbox" id="hc_strainHybrid" value="option3">Hybrid&nbsp;&nbsp;
                                    <span class="form-check-sign">
                                        <span class="check"></span>
                                    </span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="row">
                        <div class="col">
                            <b>CBD% &gt; </b> <span class="alert-doctor">(<span id="hc_cbdPercent"></span>%)</span>
                            <input id="hc_sliderCBDVal" style="width:35px; height:25px;">%
                        </div>
                    </div>
                    <div class="row">
                        <div class="col" style="min-width: 200px;">
                            <div id="hc_sliderCBDControl" class="slider"></div>
                        </div>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="row">
                        <div class="col">
                            <b>THC% &lt; </b> <span class="alert-doctor">(<span id="hc_thcPercent"></span>%)</span>
                            <input id="hc_sliderTHCVal" style="width:35px; height:25px;">%
                        </div>
                    </div>
                    <div class="row">
                        <div class="col" style="min-width: 200px;">
                            <div id="hc_sliderTHCControl" class="slider"></div>
                        </div>
                    </div>
                </div>
                <div class="col-md-auto">
                    <div class="row">
                        <div class="col">
                            <b>Format:</b> <span id="hc_format" class="alert-doctor"></span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="form-check form-check-inline" style="margin: 0px;">
                                <label class="form-check-label" style="color: #000000; padding-left: 20px;">
                                    <input class="form-check-input" type="checkbox" id="hc_formatDried" value="option1">Dried&nbsp;&nbsp;
                                    <span class="form-check-sign">
                                        <span class="check"></span>
                                    </span>
                                </label>
                            </div>
                            <div class="form-check form-check-inline" style="margin: 0px;">
                                <label class="form-check-label" style="color: #000000; padding-left: 20px;">
                                    <input class="form-check-input" type="checkbox" id="hc_formatCapsule" value="option2">Capsule&nbsp;&nbsp;
                                    <span class="form-check-sign">
                                        <span class="check"></span>
                                    </span>
                                </label>
                            </div>
                            <div class="form-check form-check-inline" style="margin: 0px;">
                                <label class="form-check-label" style="color: #000000; padding-left: 20px;">
                                    <input class="form-check-input" type="checkbox" id="hc_formatOil" value="option3">Oil&nbsp;&nbsp;
                                    <span class="form-check-sign">
                                        <span class="check"></span>
                                    </span>
                                </label>
                            </div>
                            <div class="form-check form-check-inline" style="margin: 0px;">
                                <label class="form-check-label" style="color: #000000; padding-left: 20px;">
                                    <input class="form-check-input" type="checkbox" id="hc_formatTopical" value="option2">Topical&nbsp;&nbsp;
                                    <span class="form-check-sign">
                                        <span class="check"></span>
                                    </span>
                                </label>
                            </div>
                            <div class="form-check form-check-inline" style="margin: 0px;">
                                <label class="form-check-label" style="color: #000000; padding-left: 20px;">
                                    <input class="form-check-input" type="checkbox" id="hc_formatEdible" value="option3">Edible&nbsp;&nbsp;
                                    <span class="form-check-sign">
                                        <span class="check"></span>
                                    </span>
                                </label>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- <div id="accordion" role="tablist" aria-multiselectable="true" class="card-collapse">
                <div class="card-header" role="tab" id="headingTwox" style="padding: 5px;">
                    <a class="collapsed" data-toggle="collapse" data-parent="#accordion" href="#collapseTwo"
                        aria-expanded="false" aria-controls="collapseTwo">
                        filters
                        <i class="material-icons">keyboard_arrow_down</i>
                    </a>
                </div>
                <div id="collapseTwo" class="collapse" role="tabpanel" aria-labelledby="headingTwox">
                    <div class="card-body">
                        [[ filters ]]
                    </div>
                </div>
            </div> -->
        </div>
    </div>


    <div class="card" style="margin-top: 5px; margin-bottom: 0px;">
        <div class="row">
            <div class="col-lg-9" style="padding-right: 0px;">
                <div id="hc_productList"></div>
            </div>
            <div class="col-lg-3">
                <div id="hc_productDetails">
                    [[ product details ]]
                </div>
            </div>
        </div>
    </div>




    <!-- Populate fields -->
    <script>
        function hc_populate(fld, val) {
            document.getElementById(fld).innerHTML = val;
        }
        hc_populate("hc_name", hcData.Demographics.lastName + ", " + hcData.Demographics.firstName);
        hc_populate("hc_dob", hcData.Demographics.dob);
        hc_populate("hc_gender", hcData.Demographics.gender);
        hc_populate("hc_identifiesAs", hcData.Demographics.identifiesAs);
        hc_populate("hc_height", hcData.Demographics.height);
        hc_populate("hc_weight", hcData.Demographics.weight);
        hc_populate("hc_conditions", hcData.Demographics.conditions);
        hc_populate("hc_contraindications", hcData.Demographics.contraindications);
        document.getElementById("hc_photoSml").src = hcData.Demographics.photo;
        document.getElementById("hc_photoLrg").src = hcData.Demographics.photo;
        hc_populate("hc_prescribingHCP", hcData.Clinical.prescribingHCP);
        hc_populate("hc_clinic", hcData.Clinical.clinic);
        hc_populate("hc_strain", hcData.Clinical.prescriptions.strain);
        hc_populate("hc_cbdPercent", hcData.Clinical.prescriptions.cbdPercent);
        hc_populate("hc_thcPercent", hcData.Clinical.prescriptions.thcPercent);
        hc_populate("hc_format", hcData.Clinical.prescriptions.format);
        if (hcData.Demographics.gender == hcData.Demographics.identifiesAs) {
            document.getElementById("hc_identifiesAsContainer").style = "width: 0px; height: 0px; display:inline-block; overflow: hidden";
        }
        switch (hcData.Clinical.prescriptions.strain) {
            case "Indica":
                document.getElementById("hc_strainIndica").checked = true;
                break;
            case "Sativa":
                document.getElementById("hc_strainSativa").checked = true;
                break;
            case "Hybrid":
                document.getElementById("hc_strainHybrid").checked = true;
        }
        switch (hcData.Clinical.prescriptions.format) {
            case "dried":
                document.getElementById("hc_formatDried").checked = true;
                break;
            case "capsule":
                document.getElementById("hc_formatCapsule").checked = true;
                break;
            case "oil":
                document.getElementById("hc_formatOil").checked = true;
                break;
            case "edible":
                document.getElementById("hc_formatEdible").checked = true;
                break;
            case "topical":
                document.getElementById("hc_formatTopical").checked = true;
        }
        //Some features are not available until all the libraries have loaded
        function onLoadReady() {

            //CBD Slider
            var hc_sliderCBD = document.getElementById('hc_sliderCBDControl');
            noUiSlider.create(hc_sliderCBD, {
                start: 0,
                connect: [false, true],
                step: 5,
                range: {
                    min: 0,
                    max: 100
                }
            });
            hc_sliderCBD.noUiSlider.set(hcData.Clinical.prescriptions.cbdPercent);
            var hc_sliderCBDVal = document.getElementById('hc_sliderCBDVal');
            hc_sliderCBD.noUiSlider.on('update', function (values, handle) {
                hc_sliderCBDVal.value = values[handle] * 1;
            });
            hc_sliderCBDVal.addEventListener('change', function () {
                hc_sliderCBD.noUiSlider.set(this.value);
            });

            //THC Slider
            var hc_sliderTHC = document.getElementById('hc_sliderTHCControl');
            noUiSlider.create(hc_sliderTHC, {
                start: 0,
                connect: [true, false],
                step: 5,
                range: {
                    min: 0,
                    max: 100
                }
            });
            hc_sliderTHC.noUiSlider.set(hcData.Clinical.prescriptions.thcPercent);
            var hc_sliderTHCVal = document.getElementById('hc_sliderTHCVal');
            hc_sliderTHC.noUiSlider.on('update', function (values, handle) {
                hc_sliderTHCVal.value = values[handle] * 1;
            });
            hc_sliderTHCVal.addEventListener('change', function () {
                hc_sliderTHC.noUiSlider.set(this.value);
            });

            //Product table
            var table = new Tabulator("#hc_productList", {
                height: 205, // set height of table (in CSS or here), this enables the Virtual DOM and improves render speed dramatically (can be any valid css height value)
                layout: "fitColumns", //fit columns to width of table (optional)
                data: tabledata,
                // autoColumns: true,
                columns: [ //Define Table Columns
                    { title: "Strain", field: "strain", width: 150 },
                    { title: "LP", field: "lp", align: "left" },
                    // {title:"Progress", field:"age", sorter:"number", align:"left", formatter:"progress",  editable:true, headerSort:false, headerVertical:true},
                    { title: "CBD", field: "cbd" },
                    { title: "CBD", field: "cbdProgress", formatter: "progress" },
                    { title: "THC", field: "thc" },
                    { title: "THC", field: "thcProgress", formatter: "progress" },
                    { title: "Format", field: "format" },
                    { title: "Rating", field: "rating", formatter: "star" },
                    { title: "In-stock", field: "inStock" },
                    { title: "Price", field: "displayCost", sorter: "date", align: "center" },
                ],
                rowClick: function (e, row) { //trigger an alert message when the row is clicked
                    document.getElementById('hc_productDetails').innerHTML = row.getData().id + " Clicked!!!!";
                },
            });


        };
    </script>

    <!--   Core JS Files   -->
    <script src="material-kit/assets/js/core/jquery.min.js" type="text/javascript"></script>
    <script src="material-kit/assets/js/core/popper.min.js" type="text/javascript"></script>
    <script src="material-kit/assets/js/core/bootstrap-material-design.min.js" type="text/javascript"></script>
    <script src="material-kit/assets/js/plugins/moment.min.js"></script>
    <!--	Plugin for the Datepicker, full documentation here: https://github.com/Eonasdan/bootstrap-datetimepicker -->
    <script src="material-kit/assets/js/plugins/bootstrap-datetimepicker.js" type="text/javascript"></script>
    <!--  Plugin for the Sliders, full documentation here: http://refreshless.com/nouislider/ -->
    <script src="material-kit/assets/js/plugins/nouislider.min.js" type="text/javascript"></script>
    <!--  Google Maps Plugin  -->
    <!-- <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=YOUR_KEY_HERE"></script> -->
    <!--	Plugin for Tags, full documentation here: https://github.com/bootstrap-tagsinput/bootstrap-tagsinputs  -->
    <script src="material-kit/assets/js/plugins/bootstrap-tagsinput.js"></script>
    <!--	Plugin for Select, full documentation here: http://silviomoreto.github.io/bootstrap-select -->
    <script src="material-kit/assets/js/plugins/bootstrap-selectpicker.js" type="text/javascript"></script>
    <!--	Plugin for Fileupload, full documentation here: http://www.jasny.net/bootstrap/javascript/#fileinput -->
    <script src="material-kit/assets/js/plugins/jasny-bootstrap.min.js" type="text/javascript"></script>
    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <!-- Control Center for Material Kit: parallax effects, scripts for the example pages etc -->
    <script src="material-kit/assets/js/material-kit.js?v=2.2.0" type="text/javascript"></script>
    <!-- Tabulator -->
    <!-- Run locally -->
    <link href="tabulator-master/dist/css/tabulator.min.css" rel="stylesheet">
    <script type="text/javascript" src="tabulator-master/dist/js/tabulator.min.js"></script>
    <!-- Run via CDN -->
    <!-- <link href="https://unpkg.com/tabulator-tables@4.5.2/dist/css/tabulator.min.css" rel="stylesheet">
    <script type="text/javascript" src="https://unpkg.com/tabulator-tables@4.5.2/dist/js/tabulator.min.js"></script> -->
</body>

</html>